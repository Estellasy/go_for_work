# 计算机网络八股文

## 基础
### 1. 计算机网络体系结构
计算机网络体系结构通过将复杂的网络通信分解为不同层次，来标注化交互的过程。
常见的模型包括OSI七层模型，TCP/IP四层模型和五层体系结构。
- OSI七层模型，自底向上分别为：
  - 物理层
  - 数据链路层
  - 网络层
  - 传输层
  - 会话层
  - 表示层
  - 应用层
- TCP/IP四层模型，自底向上分别为：
  - 网络接口层（物理层，数据链路层）
  - 网际层（网络层）
  - 传输层
  - 应用层（会话层、表示层、应用层）
- 五层结构
  - 物理层
  - 数据链路层
  - 网络层
  - 传输层
  - 应用层

其中，OSI为理论上的网络通信模型，TCP/IP是实际应用层面的网络通信模型，五层结构方便理解和记忆。

**OSI七层模型**
自顶向下进行描述：
- 应用层：最靠近用户的层，负责处理特定的应用程序细节。提供了网络服务与应用软件之间的接口。
  如Web浏览器、FTP客户端和服务器、电子邮件客户端等。
- 表示层：确保一个系统发送的信息可以被另一个系统的应用层读取。负责数据的转换、压缩和加密。
  如确保数据从一个编码格式转换为另一种，如ASCII到EBCDIC。
- 会话层：管理用户会话，控制网络上两节点的对话和数据交换的原理，负责建立、维护和终止会话。
- 传输层：负责端到端的通信服务，确保数据的完整性和正确顺序。包括TCP、UDP等协议。
- 数据链路层：在物理连接中提供可靠的传输，负责简历和维护相邻节点的链路，包括帧同步、MAC（媒体访问控制协议）。
- 物理层：负责在物理没接上提供可靠的传输，设计电压、接口、电缆的规格和传输速率等。

**TCP/IP四层模型**
TCP/IP模型合并了OSI的不分层次，更具有实用性。
- 应用层：对应OSI的会话层、表示层、应用层。包括所有与网络有关的高级协议，如HTTP、FTP、SMTP等。
- 传输层：负责端到端的数据传输服务，包括数据分割、流量控制、错误恢复等。有TCP和UDP。
- 网际层：负责数据包的寻址和路由，如IP和ICMP协议。
- 网络接口层：对应OSI的物理层和数据链路层，负责数据帧的物理传输，包括硬件地址寻址MAC，数据封装和解封装，错误检测和纠正。

### 2. 每一层对应的网络协议有哪些？
以OSI七层网络模型为例：
- 应用层：HTTP、DNS、FTP、NFS、Telnet、SNMP、WAIS、SMIP
- 表示层：TIFF、GIF、JPG、PICT
- 会话层：RPC、SQL、NFS、NetBIOS、names、AppleTalk
- 传输层：TCP、UDP
- 网络层：IP、ICMP、ARP、RAPP、RIP、OSPF、IPX
- 数据链路层：FDDI、HDLC
- 物理层：EIA/TIA-232

### 3. 数据在各层之间如何传输
对于发送方，从上层到下层层层包装；对于接收方，从下层到上层层层解码。
- 发送方的应用进程向接收方的应用进程传送数据。
- AP将数据交给主机的应用层，应用层添加本层控制信息h5传输到下一层。
- 传输层收到后，加上本层控制信息h4，交给网络层。
- 网络层加上本层控制信息h3，交给数据链路层。
- 数据链路层，控制信息被分为两部分，分别加到本层数据单元的首部和尾部。
- 最后的物理层进行比特流传输。

## 网络综合
### 4. 从浏览器地址栏输入 url 到显示主页的过程？
从浏览器地址栏输入url到显示主页的过程包括多个步骤，涵盖了DNS地址解析、TCP连接、发送HTTP请求、服务器处理HTTP请求并返回HTTP响应、浏览器处理并渲染页面等多个环节。
- DNS地址解析：浏览器发起一个DNS请求到DNS服务器，将域名解析为服务器的IP地址；
  **DNS协议：获取域名对应的IP，DNS查找过程：浏览器缓存、本地DNS路由缓存、DNS解析服务**
- TCP连接：通过解析到的IP地址建立TCP连接（一般是443端口建立SSL加密的HTTPS连接），涉及TCP的三次握手，确保双方都准备好数据进行传输；
  **TCP：与服务端建立连接和断开连接；IP：TCP协议基于IP协议；OSPF：IP数据包在路由器之间的路由选择；ARP：路由器与服务器通信时，将IP地址转换为MAC地址；HTTP：建立好TCP连接后，使用HTTP协议传递HTTP报文**
- 发送HTTP请求：浏览器构建HTTP请求消息，包括请求行（如GET / HTTP/1.1）、请求头（包括用户代理、接收的内容信息等）、请求体，将请求发送到服务器；
- 服务器处理请求：服务端接收到HTTP请求后，根据请求的资源路径， 经过后端处理，生成HTTP响应消息，包括状态行（如HTTP/1.1 200 OK）、响应头和响应体；
- 浏览器接收HTTP响应：浏览器接收到服务器发送的HTTP响应，开始解析响应体的HTML内容，构建DOM树，解析CSS和JS等文件，最终渲染页面。
- 断开连接：TCP四次握手，连接结束。

### 5. DNS解析过程
DNS的英文全称是Domain Name System，即域名解析系统，作用就是域名和IP相互映射。

查询域名对应IP地址的流程：
- 查浏览器缓存；
- 查本地DNS服务器；
- 本地DNS服务器向根域名服务器发送请求，根域名服务器负责返回对应顶级域名服务器IP地址的列表；
- 本地DNS服务器向顶级域名服务器发送请求，获得权限域名服务器IP地址列表；
- 本地DNS服务器向权限域名服务器发送请求，获得具体IP地址。

### 6. WebSocket和Socket的区别？
Socket是一个网络编程的标准接口，而WebSocket是应用层通信协议。
- Socket其实就等于**IP地址+端口+协议**。
具体而言，Socket是一套标准，完成了对TCP/IP的高度封装，屏蔽了物理细节，以便网络开发者更好地进行网络编程。
- WebSocket是一个持久化协议。
WebSocket为了解决http不支持持久化连接的问题。

**拓展**：介绍一下WebSocket协议，为什么有了HTTP还要有WebSocket？

### 7. 常见端口和对应服务
- 21：FTP
- 22：SSH
- 23：Telnet，远程登录服务
- 53：DNS域名解析
- 80：HTTP超文本传输协议
- 443：HTTPS
- 1080：Sockets
- 3306：MySQL默认端口号

## HTTP
### 8. HTTP常见状态码和含义
HTTP的分类：
- 1XX：信息性状态码
- 2XX：成功状态码
- 3XX：重定向状态码
- 4XX：客户端错误状态码
- 5XX：服务端错误状态码

几个常用的具体状态码的含义：
- 101：切换请求协议
- 200：请求成功
- 301：请求资源永久移动，返回新的URI地址。
- 302：请求资源临时移动，继续使用原有URI。此时服务端从另外的地址相应资源。
- 400：客户端请求语法错误，服务端无法理解
- 401：当前请求需要认证
- 403：服务端理解请求，但拒绝执行
- 500：服务器内部错误

### 9. HTTP请求有哪些方式
- GET：查，向服务器获取简单请求；
- POST：增，提交数据请求；
- PUT：改，修改指定资源；
- DELETE：删，删除URI标记的指定资源；
- CONNECT：用于代理服务器；
- TRANCE：用于回环测试；
- OPTIONS：返回所有可用方法；
- HEAD：获取URL标记资源的首部。

### 10. GET和POST的区别
- 传参方式不同
- 幂等和安全性不同
- 可被缓存不同

1. 从HTTP报文层面看，GET将请求内容放在URL，POST将请求信息放在请求体。
   这一点导致GET请求携带的数据量有限，因为URL本身是有长度限制的，而POST请求放在请求体中，没有大小限制。GET不安全，POST较为安全；
2. 从数据库层面来说，GET符合幂等性和安全性，而POST请求不符合。
   GET请求用于查看信息，不改变；而POST请求用来修改服务器信息。
3. GET能被缓存，GET请求保存在浏览器的浏览记录里，GET请求的URL能够保存为书签。
   因为它的幂等性和安全性，除了返回结果没有其他多余的动作，因此绝大部分的 GET 请求都被 CDN 缓存起来了，大大减少了 Web 服务器的负担。

### 11. GET的长度限制
HTTP 中的 GET 方法是通过 URL 传递数据的，但是 URL 本身其实并没有对数据的长度进行限制，真正限制 GET 长度的是**浏览器**。
针对真个URL有长度限制，如IE浏览器为2000多字符，FireFox为65536个，Chrome为8182个。

### 12. HTTP的请求过程和原理
HTTP的全称是超文本传输协议 HyperText Transfer Protocol，是一个基于请求/响应模式的应用层协议，基于TCP/IP协议传输数据。

HTTP协议遵循标准的Client-Server模型，客户端打开连接并发出请求，等待服务端响应。
- 在浏览器输入 URL 后，浏览器首先会通过 DNS 解析获取到服务器的 IP 地址，然后与服务器建立 TCP 连接；
- TCP 连接建立后，浏览器会向服务器发送 HTTP 请求；
- 服务器收到请求后，会根据请求的信息处理请求；
- 处理完请求后，服务器返回HTTP响应到浏览器；
- 浏览器收到响应，根据响应的信息渲染页面；
- 随后关闭TCP连接。

客户端发送一个请求到服务器，服务器处理请求并返回一个响应。这个过程是同步的，也就是说，客户端在发送请求后必须等待服务器的响应。在等待响应的过程中，**客户端不会发送其他请求**。

### 13. HTTP的报文结构
HTTP报文结构分为两类，请求报文和响应报文。
- 报文头
  - 请求行/状态行
  - 请求/响应首部字段
  - 通用首部字段
  - 实体首部字段
  - 其他
- 空行（CR+LF）
- 请求体

**请求报文结构**
```http
GET /index.html HTTP/1.1
Host: www.javabetter.cn
Accept: text/html
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
```

- 请求行：包括方法（如 GET、POST）、请求的 URL 和 HTTP 协议的版本。例如：GET /index.html HTTP/1.1。
- 请求头：请求的附加信息，如客户端想要接收的内容类型、浏览器类型等。
  请求头由key-value组成，用冒号分割，一行表示一个键值对。
- 空行：标识请求头部结束
- 消息正文：请求的具体内容

**响应报文结构**
```http
HTTP/1.0 200 OK
Content-Type: text/plain
Content-Length: 137582
Expires: Thu, 05 Dec 1997 16:00:00 GMT
Last-Modified: Wed, 5 August 1996 15:55:28 GMT
Server: Apache 0.84
<html>
  <body>沉默王二很天真</body>
</html>
```
- 状态行：包括HTTP协议的版本、状态码和状态消息。
- 响应头：包含响应的附加信息，如服务器类型、内容类型、内容长度等，也是键值对。
- 空行：标识响应头部结束
- 消息正文：响应的具体内容，如HTML页面。
  
### 14. URI和URL的区别
URL是URI的子集。
- URI：统一资源标识符，标识Web上每一种可用资源。（理解为身份证）
- URI：统一资源定位符，提供资源的路径。（理解为住址）

### 15. HTTP1.0，1.1，2.0 的区别
> 一句话描述：HTTP1.0默认短连接，HTTP1.1默认长连接，HTTP2.0采用多路复用。

**HTTP1.0**
- 无状态协议：每个请求之间相互独立，服务端不保存任何请求的状态信息；
- 非持久连接：每个HTTP请求/响应之后，连接会被关闭，属于短连接。可以设置Connection字段`Connection: keep-alive`强制开启长连接；
> HTTP为什么是无状态的？

**HTTP1.1**
- 持久连接：HTTP1.1引入了持久连接，可以在一个连接上发送多个请求和响应，极大减轻了TCP连接的开销；
- 流水线处理：HTTP1.1支持客户端在前一个请求的响应达到之前发送下一个请求，以提高传输效率；

**HTTP2.0**
- 二进制协议：HTTP 2.0 使用二进制而不是文本格式来传输数据，解析更加高效。
- 多路复用：一个 TCP 连接上可以同时进行多个 HTTP 请求/响应，解决了 HTTP 1.x 的队头阻塞问题。
- 头部压缩：HTTP 协议不带状态，所以每次请求都必须附上所有信息。HTTP 2.0 引入了头部压缩机制，可以使用 gzip 或 compress 压缩后再发送，减少了冗余头部信息的带宽消耗。
- 服务端推送：服务器可以主动向客户端推送资源，而不需要客户端明确请求。

### 16. HTTP/3

### 17. HTTP 如何实现长连接？在什么时候会超时

### 18. HTTP与HTTPS的区别

### 19. 为什么要用HTTPS，解决了哪些问题？

### 20. HTTPS的工作流程